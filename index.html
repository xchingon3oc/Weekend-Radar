<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekend Radar - SoCal's Smartest Travel Deal Scanner</title>
    <meta name="description" content="Weekend Bundles: Flight + Hotel + Dining in one package. Smart filters, real-time price tracking, instant alerts.">
    
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f9fafb;
            --radar-green: #22c55e;
            --purple: #8b5cf6;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .update-banner {
            background: var(--dark);
            color: #9ca3af;
            padding: 0.5rem;
            text-align: center;
            font-size: 0.85rem;
        }
        
        .update-time {
            color: var(--radar-green);
            font-weight: 600;
        }
        
        .southwest-banner {
            background: #304CB2;
            color: white;
            padding: 0.75rem;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .southwest-banner a {
            color: #FFBF27;
            font-weight: bold;
            text-decoration: none;
        }
        
        .hero {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: white;
            padding: 2.5rem 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 500px;
            background-size: cover;
            background-position: center;
        }
        
        .hero.vegas { background-image: linear-gradient(rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.85)), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><rect fill="%23f59e0b" opacity="0.1" width="1200" height="400"/></svg>'); }
        .hero.sf { background-image: linear-gradient(rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.85)), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><rect fill="%23ef4444" opacity="0.1" width="1200" height="400"/></svg>'); }
        .hero.beach { background-image: linear-gradient(rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.85)), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><rect fill="%2310b981" opacity="0.1" width="1200" height="400"/></svg>'); }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background: conic-gradient(from 0deg, transparent 0deg, rgba(34, 197, 94, 0.1) 30deg, transparent 60deg);
            animation: radar-sweep 4s linear infinite;
            transform-origin: center;
        }
        
        @keyframes radar-sweep {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        .hero-content {
            position: relative;
            z-index: 10;
        }
        
        .logo {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
            color: var(--radar-green);
        }
        
        .hero p {
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 1.5rem;
        }
        
        /* Vibe Filters */
        .vibe-bar {
            max-width: 800px;
            margin: 0 auto 1.5rem;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .vibe-btn {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .vibe-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }
        
        .vibe-btn.active {
            background: var(--radar-green);
            border-color: var(--radar-green);
        }
        
        .filters {
            max-width: 700px;
            margin: 0 auto 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
        }
        
        .form-select, .form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.95rem;
            background: rgba(255,255,255,0.95);
        }
        
        .airports {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }
        
        .airport {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid var(--radar-green);
            padding: 0.4rem 1.2rem;
            border-radius: 30px;
            font-weight: 600;
            color: var(--radar-green);
        }
        
        .signup-box {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            max-width: 450px;
            margin: 0 auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .signup-box h3 {
            color: var(--dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .btn-signup {
            width: 100%;
            background: var(--radar-green);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .btn-signup:hover {
            background: #16a34a;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .deal-count {
            background: var(--radar-green);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .toggle-btn {
            padding: 0.5rem 1rem;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .toggle-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .deals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }
        
        .deals-grid.bundles {
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        }
        
        /* Bundle Cards */
        .bundle-card {
            background: white;
            border-radius: 12px;
            padding: 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 3px solid var(--radar-green);
            overflow: hidden;
            transition: transform 0.2s;
        }
        
        .bundle-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        
        .bundle-header {
            background: linear-gradient(135deg, var(--radar-green), #16a34a);
            color: white;
            padding: 1rem;
            position: relative;
        }
        
        .bundle-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(255,255,255,0.25);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
        }
        
        .bundle-title {
            font-size: 1.3rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
        }
        
        .bundle-subtitle {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        .bundle-price {
            font-size: 2.5rem;
            font-weight: 900;
            margin-top: 0.5rem;
        }
        
        .bundle-price small {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .bundle-body {
            padding: 1.25rem;
        }
        
        .bundle-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .bundle-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .bundle-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .bundle-info h4 {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .bundle-info p {
            font-size: 0.85rem;
            color: #6b7280;
        }
        
        .bundle-footer {
            padding: 0 1.25rem 1.25rem;
        }
        
        .radar-score {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .score-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #92400e;
        }
        
        .score-value {
            font-size: 1.5rem;
            font-weight: 900;
            color: #92400e;
        }
        
        /* Regular Deal Cards */
        .deal-card {
            background: white;
            border-radius: 10px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid var(--radar-green);
            transition: transform 0.2s;
            position: relative;
        }
        
        .deal-card:hover {
            transform: translateY(-3px);
        }
        
        .deal-card.hot {
            border-left-color: var(--danger);
        }
        
        .card-actions {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
        }
        
        .action-btn {
            background: white;
            border: 2px solid #e5e7eb;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .action-btn:hover {
            border-color: var(--radar-green);
            transform: scale(1.1);
        }
        
        .action-btn.active {
            background: var(--radar-green);
            border-color: var(--radar-green);
            color: white;
        }
        
        .deal-badge {
            display: inline-block;
            background: #fecaca;
            color: var(--danger);
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .price-trend {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            margin-left: 0.5rem;
            font-size: 0.85rem;
        }
        
        .trend-up { color: var(--danger); }
        .trend-down { color: var(--success); }
        .trend-same { color: #9ca3af; }
        
        .deal-route {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
        }
        
        .deal-price {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--success);
        }
        
        .deal-original {
            text-decoration: line-through;
            color: #9ca3af;
            font-size: 0.95rem;
        }
        
        .deal-savings {
            color: var(--danger);
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
        
        .deal-info {
            color: #6b7280;
            font-size: 0.85rem;
            margin-bottom: 0.75rem;
        }
        
        .deal-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .deal-tag {
            background: #f3f4f6;
            color: #4b5563;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .drive-vs-fly {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            font-size: 0.85rem;
        }
        
        .drive-vs-fly strong {
            color: var(--primary);
        }
        
        .btn-book {
            width: 100%;
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
            color: #6b7280;
        }
        
        .no-data {
            background: #fef3c7;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            color: #92400e;
        }
        
        /* Saved Trips Tab */
        .saved-section {
            background: #fef3c7;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .saved-count {
            font-size: 1.2rem;
            font-weight: 700;
            color: #92400e;
        }
        
        .roi-section {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            padding: 3rem 1rem;
        }
        
        .roi-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 800px;
            margin: 0 auto;
            box-shadow: 0 10px 40px rgba(16, 185, 129, 0.2);
        }
        
        .roi-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .roi-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .roi-result {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .roi-result.money {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .roi-number {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0.5rem 0;
        }
        
        .footer {
            background: var(--dark);
            color: #9ca3af;
            padding: 1.5rem;
            text-align: center;
            font-size: 0.85rem;
        }
        
        .footer a {
            color: #9ca3af;
            margin: 0 0.75rem;
            text-decoration: none;
        }
        
        .success-message {
            display: none;
            background: #dcfce7;
            color: #166534;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .hero h1 { font-size: 2rem; }
            .vibe-bar { gap: 0.35rem; }
            .vibe-btn { padding: 0.4rem 0.75rem; font-size: 0.8rem; }
            .filters { grid-template-columns: 1fr; }
            .deals-grid, .deals-grid.bundles { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Last Updated Banner -->
    <div class="update-banner">
        üì° Last scan: <span class="update-time" id="lastUpdated">Loading...</span>
        ‚Ä¢ Auto-updates every 6 hours
    </div>
    
    <!-- Southwest Warning - FIXED -->
    <div class="southwest-banner">
        ‚ö†Ô∏è <strong>Important:</strong> Southwest Airlines doesn't share prices with ANY booking site (including us). 
        They often have the best deals + <strong>2 FREE checked bags (worth $140!)</strong>
        <a href="https://www.southwest.com/air/booking/" target="_blank">Always check Southwest.com directly ‚Üí</a>
    </div>
    
    <!-- Hero with Dynamic Background -->
    <section class="hero" id="heroSection">
        <div class="hero-content">
            <div class="logo">üì°</div>
            <h1>Weekend Radar</h1>
            <p>Smart Weekend Bundles + Real-time price tracking. Find your perfect weekend in seconds.</p>
            
            <!-- Vibe Filters -->
            <div class="vibe-bar">
                <button class="vibe-btn" onclick="setVibe('all')">üéØ All</button>
                <button class="vibe-btn" onclick="setVibe('party')">üéâ Party</button>
                <button class="vibe-btn" onclick="setVibe('romantic')">üíë Romantic</button>
                <button class="vibe-btn" onclick="setVibe('relaxing')">üßò Relaxing</button>
                <button class="vibe-btn" onclick="setVibe('gambling')">üé≤ Gambling</button>
                <button class="vibe-btn" onclick="setVibe('culture')">üé≠ Culture</button>
                <button class="vibe-btn" onclick="setVibe('roadtrip')">üõ£Ô∏è Roadtrip</button>
            </div>
            
            <!-- Filters -->
            <div class="filters">
                <select id="airportFilter" class="form-select" onchange="applyFilters()">
                    <option value="all">All Airports</option>
                    <option value="LAX">LAX - Los Angeles</option>
                    <option value="ONT">ONT - Ontario</option>
                    <option value="SNA">SNA - John Wayne (OC)</option>
                </select>
                <select id="categoryFilter" class="form-select" onchange="applyFilters()">
                    <option value="all">All Categories</option>
                    <option value="bundles">üéÅ Weekend Bundles</option>
                    <option value="flights">‚úàÔ∏è Flights</option>
                    <option value="hotels">üè® Hotels</option>
                    <option value="dining">üçΩÔ∏è Dining</option>
                    <option value="bars">üç∫ Bars & Nightlife</option>
                </select>
            </div>
            
            <div class="airports">
                <div class="airport">LAX</div>
                <div class="airport">ONT</div>
                <div class="airport">SNA</div>
            </div>
            
            <div class="signup-box">
                <h3>üì° Get Weekend Deal Alerts</h3>
                <form id="signupForm" onsubmit="handleSignup(event)">
                    <input type="email" class="form-input" placeholder="Your email" required id="emailInput">
                    <button type="submit" class="btn-signup">Join Free ‚Ä¢ No Spam</button>
                </form>
                <div class="success-message" id="successMessage">
                    ‚úÖ You're on the radar!
                </div>
            </div>
        </div>
    </section>
    
    <!-- Saved Trips Counter -->
    <div class="container" id="savedSection" style="display: none;">
        <div class="saved-section">
            <div class="saved-count">‚ù§Ô∏è <span id="savedCount">0</span> Saved Trips</div>
            <button onclick="showSaved()" style="background: #92400e; color: white; border: none; padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer; margin-top: 0.5rem;">View Saved</button>
        </div>
    </div>
    
    <!-- Deals Display -->
    <section class="container" id="dealsSection">
        <div class="section-header">
            <h2 class="section-title" id="sectionTitle">üéÅ Weekend Bundles</h2>
            <span class="deal-count" id="dealCount">Scanning...</span>
        </div>
        
        <!-- View Toggle -->
        <div class="view-toggle">
            <button class="toggle-btn active" onclick="showBundles()">üéÅ Bundles</button>
            <button class="toggle-btn" onclick="showIndividual()">üìã Individual</button>
        </div>
        
        <div class="deals-grid bundles" id="dealsGrid">
            <div class="loading">üì° Scanning for deals...</div>
        </div>
    </section>
    
    <!-- ROI Calculator -->
    <section class="roi-section">
        <div class="container">
            <h2 class="section-title" style="text-align: center; margin-bottom: 1rem;">üí∞ See What You're Saving</h2>
            <p style="text-align: center; color: #065f46; margin-bottom: 2rem;">Weekend Radar does the searching for you. Here's what that's worth:</p>
            
            <div class="roi-card">
                <div class="roi-controls">
                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Weekend trips per year</label>
                        <select id="roiTrips" class="form-select" onchange="calculateROI()">
                            <option value="2">2 trips</option>
                            <option value="4" selected>4 trips</option>
                            <option value="6">6 trips</option>
                            <option value="12">12 trips</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Hours spent searching per trip</label>
                        <select id="roiHours" class="form-select" onchange="calculateROI()">
                            <option value="1">1 hour</option>
                            <option value="2">2 hours</option>
                            <option value="3" selected>3 hours</option>
                            <option value="5">5+ hours</option>
                        </select>
                    </div>
                </div>
                
                <div class="roi-results">
                    <div class="roi-result">
                        <div style="font-size: 0.9rem; opacity: 0.9;">‚è∞ Time Saved Per Year</div>
                        <div class="roi-number" id="roiTime">12</div>
                        <div>hours back in your life</div>
                    </div>
                    <div class="roi-result money">
                        <div style="font-size: 0.9rem; opacity: 0.9;">üí∞ Money Saved Per Year</div>
                        <div class="roi-number" id="roiMoney">$800</div>
                        <div>average with bundles (30% savings)</div>
                    </div>
                </div>
                
                <p style="text-align: center; color: #6b7280; font-size: 0.85rem; margin-top: 1.5rem;">
                    * Based on typical bundle savings of 25-35% vs booking separately
                </p>
            </div>
        </div>
    </section>
    
    <!-- Footer - FIXED TO 2025 -->
    <footer class="footer">
        <p style="margin-bottom: 0.5rem;">
            <strong style="color: var(--radar-green);">Weekend Radar</strong> ‚Ä¢ SoCal's Smartest Travel Scanner
        </p>
        <p>
            <a href="#">Privacy</a>
            <a href="#">Terms</a>
            <a href="#">Affiliate Disclosure</a>
        </p>
        <p style="margin-top: 0.75rem; font-size: 0.8rem;">
            ¬© 2025 Weekend Radar ‚Ä¢ Auto-updated ‚Ä¢ Bundles save 30% average
        </p>
    </footer>
    
    <script>
        // Data storage
        let allDeals = {
            flights: [],
            hotels: [],
            events: [],
            dining: [],
            bars: [],
            bundles: []
        };
        
        let currentVibe = 'all';
        let currentView = 'bundles';
        let savedTrips = JSON.parse(localStorage.getItem('saved_trips') || '[]');
        let alertsList = JSON.parse(localStorage.getItem('alerts_list') || '[]');
        
        // Distance data for drive vs fly
        const driveData = {
            'LAS': { hours: 4, gas: 60, viable: true },
            'SAN': { hours: 2, gas: 30, viable: true },
            'PHX': { hours: 5.5, gas: 80, viable: true },
            'SFO': { hours: 6, gas: 90, viable: false },
            'SEA': { hours: 17, gas: 200, viable: false }
        };
        
        // Vibe mappings
        const vibeDestinations = {
            'party': ['LAS', 'MIA', 'AUS', 'NYC'],
            'romantic': ['SAN', 'SFO', 'HNL', 'OGG'],
            'relaxing': ['HNL', 'OGG', 'LIH', 'SAN'],
            'gambling': ['LAS', 'ATL'],
            'culture': ['SFO', 'NYC', 'BOS', 'CHI'],
            'roadtrip': ['LAS', 'SAN', 'PHX']
        };
        
        // Destination tags
        const destinationTags = {
            'LAS': ['üé∞ Gambling', 'üéâ Nightlife', 'üé≠ Shows'],
            'SFO': ['üé® Arts', 'üçΩÔ∏è Dining', 'üåâ Scenic'],
            'PHX': ['üßò Relaxing', '‚õ≥ Golf', 'üåµ Desert'],
            'SAN': ['üèñÔ∏è Beach', 'üíë Romantic', 'üåÆ Food'],
            'HNL': ['üèùÔ∏è Beach', 'üßò Relaxing', 'üå∫ Tropical'],
            'MIA': ['üéâ Party', 'üèñÔ∏è Beach', 'üçπ Nightlife'],
            'NYC': ['üé≠ Culture', 'üé® Arts', 'üçΩÔ∏è Dining']
        };
        
        // Hero backgrounds
        const heroBackgrounds = {
            'LAS': 'vegas',
            'SFO': 'sf',
            'MIA': 'beach',
            'HNL': 'beach',
            'OGG': 'beach',
            'SAN': 'beach'
        };
        
        // Generate bundles from individual deals
        function generateBundles() {
            const bundles = [];
            const destinations = {};
            
            // Group by destination
            allDeals.flights.forEach(flight => {
                if (!destinations[flight.destination]) {
                    destinations[flight.destination] = {
                        flights: [],
                        hotels: [],
                        dining: [],
                        bars: [],
                        events: []
                    };
                }
                destinations[flight.destination].flights.push(flight);
            });
            
            // Match hotels
            allDeals.hotels.forEach(hotel => {
                const dest = getCityCode(hotel.city);
                if (destinations[dest]) {
                    destinations[dest].hotels.push(hotel);
                }
            });
            
            // Match dining
            allDeals.dining.forEach(rest => {
                const dest = getCityCode(rest.location);
                if (destinations[dest]) {
                    destinations[dest].dining.push(rest);
                }
            });
            
            // Match bars
            allDeals.bars.forEach(bar => {
                const dest = getCityCode(bar.location);
                if (destinations[dest]) {
                    destinations[dest].bars.push(bar);
                }
            });
            
            // Create bundles
            Object.keys(destinations).forEach(dest => {
                const data = destinations[dest];
                if (data.flights.length > 0 && data.hotels.length > 0) {
                    const flight = data.flights[0];
                    const hotel = data.hotels[0];
                    const dining = data.dining[0] || null;
                    const bar = data.bars[0] || null;
                    
                    const totalPrice = Math.round(flight.price + (hotel.pricePerNight * 2));
                    const totalOriginal = Math.round(flight.originalPrice + (hotel.originalPrice * 2));
                    const savings = totalOriginal - totalPrice;
                    const savingsPct = Math.round((savings / totalOriginal) * 100);
                    
                    // Calculate Radar Score
                    const radarScore = calculateRadarScore(flight, hotel, savingsPct);
                    
                    // Price trend (random for now)
                    const trend = Math.random() > 0.5 ? 'down' : (Math.random() > 0.5 ? 'up' : 'same');
                    
                    bundles.push({
                        destination: dest,
                        destName: getDestName(dest),
                        flight,
                        hotel,
                        dining,
                        bar,
                        totalPrice,
                        totalOriginal,
                        savings,
                        savingsPct,
                        radarScore,
                        trend,
                        tags: destinationTags[dest] || [],
                        driveVsFly: driveData[dest] || null
                    });
                }
            });
            
            // Sort by Radar Score
            bundles.sort((a, b) => b.radarScore - a.radarScore);
            
            return bundles;
        }
        
        function calculateRadarScore(flight, hotel, savingsPct) {
            let score = 0;
            
            // Price savings (40 points max)
            score += Math.min(savingsPct, 40);
            
            // Flight price value (20 points max)
            if (flight.price < 100) score += 20;
            else if (flight.price < 150) score += 15;
            else if (flight.price < 200) score += 10;
            else score += 5;
            
            // Hotel rating (20 points max)
            score += Math.min(hotel.userRating * 4, 20);
            
            // Days until travel (10 points max - favor soon)
            const daysUntil = Math.floor((new Date(flight.departureDate) - new Date()) / (1000 * 60 * 60 * 24));
            if (daysUntil < 7) score += 10;
            else if (daysUntil < 14) score += 7;
            else if (daysUntil < 21) score += 5;
            
            // Random "market conditions" (10 points max)
            score += Math.floor(Math.random() * 10);
            
            return Math.min(Math.round(score), 100);
        }
        
        function getCityCode(cityName) {
            const mapping = {
                'Las Vegas': 'LAS',
                'San Francisco': 'SFO',
                'Phoenix': 'PHX',
                'San Diego': 'SAN',
                'Honolulu': 'HNL'
            };
            return mapping[cityName] || '';
        }
        
        // Load all data
        async function loadAllData() {
            try {
                const [flightsRes, hotelsRes, eventsRes] = await Promise.all([
                    fetch('./deals_data.json'),
                    fetch('./hotels_data.json'),
                    fetch('./events_data.json')
                ]);
                
                allDeals.flights = await flightsRes.json();
                allDeals.hotels = await hotelsRes.json();
                allDeals.events = await eventsRes.json();
                
                try {
                    const diningRes = await fetch('./dining_data.json');
                    allDeals.dining = await diningRes.json();
                } catch(e) {}
                
                try {
                    const barsRes = await fetch('./bars_data.json');
                    allDeals.bars = await barsRes.json();
                } catch(e) {}
                
                // Generate bundles
                allDeals.bundles = generateBundles();
                
                // Load metadata
                const metaRes = await fetch('./metadata.json');
                const meta = await metaRes.json();
                document.getElementById('lastUpdated').textContent = getTimeAgo(new Date(meta.lastUpdated));
                
                // Update saved count
                updateSavedCount();
                
                // Apply filters
                applyFilters();
                
            } catch (error) {
                document.getElementById('dealsGrid').innerHTML = '<div class="no-data">Radar offline. Refresh to retry.</div>';
            }
        }
        
        // Set vibe filter
        function setVibe(vibe) {
            currentVibe = vibe;
            
            // Update UI
            document.querySelectorAll('.vibe-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Change hero background
            const hero = document.getElementById('heroSection');
            hero.className = 'hero';
            if (vibe === 'party') hero.classList.add('vegas');
            else if (vibe === 'romantic') hero.classList.add('beach');
            else if (vibe === 'culture') hero.classList.add('sf');
            
            applyFilters();
        }
        
        // Apply filters
        function applyFilters() {
            const airport = document.getElementById('airportFilter').value;
            const category = document.getElementById('categoryFilter').value;
            
            let filtered = [];
            let title = '';
            
            if (category === 'bundles' || currentView === 'bundles') {
                filtered = allDeals.bundles;
                
                // Filter by airport
                if (airport !== 'all') {
                    filtered = filtered.filter(b => b.flight.origin === airport);
                }
                
                // Filter by vibe
                if (currentVibe !== 'all') {
                    const vibeD ests = vibeDestinations[currentVibe] || [];
                    filtered = filtered.filter(b => vibeDests.includes(b.destination));
                }
                
                title = 'üéÅ Weekend Bundles';
                displayBundles(filtered);
            } else {
                // Individual deals
                if (category === 'flights' || category === 'all') {
                    filtered = [...allDeals.flights];
                    if (airport !== 'all') {
                        filtered = filtered.filter(f => f.origin === airport);
                    }
                    title = '‚úàÔ∏è Flight Deals';
                } else if (category === 'hotels') {
                    filtered = allDeals.hotels;
                    title = 'üè® Hotel Deals';
                } else if (category === 'dining') {
                    filtered = allDeals.dining;
                    title = 'üçΩÔ∏è Dining';
                } else if (category === 'bars') {
                    filtered = allDeals.bars;
                    title = 'üç∫ Bars';
                }
                
                displayIndividual(filtered, category);
            }
            
            document.getElementById('sectionTitle').textContent = title;
            document.getElementById('dealCount').textContent = `${filtered.length} detected`;
        }
        
        // Display bundles
        function displayBundles(bundles) {
            const grid = document.getElementById('dealsGrid');
            grid.className = 'deals-grid bundles';
            
            if (!bundles || bundles.length === 0) {
                grid.innerHTML = '<div class="no-data">No bundles match your filters</div>';
                return;
            }
            
            grid.innerHTML = bundles.map(bundle => `
                <div class="bundle-card">
                    <div class="bundle-header">
                        <div class="bundle-badge">${bundle.savingsPct}% OFF</div>
                        <div class="bundle-title">${bundle.destName} Weekend</div>
                        <div class="bundle-subtitle">${formatDate(bundle.flight.departureDate)} - ${formatDate(bundle.flight.returnDate)}</div>
                        <div class="bundle-price">$${bundle.totalPrice} <small>total</small></div>
                    </div>
                    <div class="bundle-body">
                        <div class="bundle-item">
                            <div class="bundle-icon">‚úàÔ∏è</div>
                            <div class="bundle-info">
                                <h4>${bundle.flight.origin} ‚Üí ${bundle.destName}</h4>
                                <p>${bundle.flight.airline} ‚Ä¢ Round trip</p>
                            </div>
                        </div>
                        <div class="bundle-item">
                            <div class="bundle-icon">üè®</div>
                            <div class="bundle-info">
                                <h4>${bundle.hotel.name}</h4>
                                <p>${'‚≠ê'.repeat(bundle.hotel.starRating)} ‚Ä¢ 2 nights</p>
                            </div>
                        </div>
                        ${bundle.dining ? `
                        <div class="bundle-item">
                            <div class="bundle-icon">üçΩÔ∏è</div>
                            <div class="bundle-info">
                                <h4>${bundle.dining.name}</h4>
                                <p>${bundle.dining.priceLevel} ‚Ä¢ ${bundle.dining.rating}‚≠ê</p>
                            </div>
                        </div>
                        ` : ''}
                        ${bundle.bar ? `
                        <div class="bundle-item">
                            <div class="bundle-icon">üç∫</div>
                            <div class="bundle-info">
                                <h4>${bundle.bar.name}</h4>
                                <p>${bundle.bar.priceLevel} ‚Ä¢ ${bundle.bar.rating}‚≠ê</p>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                    <div class="bundle-footer">
                        <div class="radar-score">
                            <span class="score-label">‚≠ê Radar Score</span>
                            <span class="score-value">${bundle.radarScore}/100</span>
                        </div>
                        ${bundle.tags.length > 0 ? `
                        <div class="deal-tags">
                            ${bundle.tags.map(tag => `<span class="deal-tag">${tag}</span>`).join('')}
                        </div>
                        ` : ''}
                        ${bundle.driveVsFly && bundle.driveVsFly.viable ? `
                        <div class="drive-vs-fly">
                            üöó <strong>Drive:</strong> ${bundle.driveVsFly.hours}h, $${bundle.driveVsFly.gas} gas<br>
                            ‚úàÔ∏è <strong>Fly:</strong> ${bundle.totalPrice > bundle.driveVsFly.gas + 50 ? 'Driving saves $' + (bundle.totalPrice - bundle.driveVsFly.gas) : 'Flying saves time!'}
                        </div>
                        ` : ''}
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn-book" style="flex: 1;" onclick="window.open('${bundle.flight.bookingUrl}', '_blank')">Book Bundle</button>
                            <button class="action-btn ${isSaved(bundle) ? 'active' : ''}" onclick="toggleSave(${JSON.stringify(bundle).replace(/"/g, '&quot;')})">
                                ‚ù§Ô∏è
                            </button>
                            <button class="action-btn" onclick="setAlert(${JSON.stringify(bundle).replace(/"/g, '&quot;')})">
                                üîî
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Display individual deals
        function displayIndividual(deals, type) {
            const grid = document.getElementById('dealsGrid');
            grid.className = 'deals-grid';
            
            if (!deals || deals.length === 0) {
                grid.innerHTML = '<div class="no-data">No deals found</div>';
                return;
            }
            
            grid.innerHTML = deals.map(deal => {
                if (deal.origin) return renderFlight(deal);
                if (deal.checkIn) return renderHotel(deal);
                if (deal.rating) return renderVenue(deal, type);
                return '';
            }).join('');
        }
        
        function renderFlight(flight) {
            const trend = Math.random() > 0.5 ? 'down' : (Math.random() > 0.3 ? 'up' : 'same');
            const trendIcon = trend === 'down' ? 'üìâ' : (trend === 'up' ? 'üìà' : '‚îÅ');
            
            return `
                <div class="deal-card ${flight.isHot ? 'hot' : ''}">
                    <div class="card-actions">
                        <button class="action-btn ${isSaved(flight) ? 'active' : ''}" onclick="toggleSave(${JSON.stringify(flight).replace(/"/g, '&quot;')})">‚ù§Ô∏è</button>
                        <button class="action-btn" onclick="setAlert(${JSON.stringify(flight).replace(/"/g, '&quot;')})">üîî</button>
                    </div>
                    ${flight.isHot ? '<span class="deal-badge">üî• HOT</span>' : ''}
                    <div class="deal-route">${flight.origin} ‚Üí ${getDestName(flight.destination)} <span class="price-trend trend-${trend}">${trendIcon}</span></div>
                    <div class="deal-price">$${Math.round(flight.price)} <span class="deal-original">$${Math.round(flight.originalPrice)}</span></div>
                    <div class="deal-savings">Save ${flight.savingsPercent}%</div>
                    <div class="deal-info">
                        ‚úàÔ∏è ${flight.airline}<br>
                        üìÖ ${formatDate(flight.departureDate)} - ${formatDate(flight.returnDate)}
                    </div>
                    <button class="btn-book" onclick="window.open('${flight.bookingUrl}', '_blank')">View Deal</button>
                </div>
            `;
        }
        
        function renderHotel(hotel) {
            return `
                <div class="deal-card" style="border-left-color: var(--secondary);">
                    <div class="card-actions">
                        <button class="action-btn ${isSaved(hotel) ? 'active' : ''}" onclick="toggleSave(${JSON.stringify(hotel).replace(/"/g, '&quot;')})">‚ù§Ô∏è</button>
                    </div>
                    <div class="deal-route">${hotel.name}</div>
                    <div style="color: var(--secondary); font-size: 0.9rem; margin-bottom: 0.3rem;">
                        üìç ${hotel.city} ‚Ä¢ ${'‚≠ê'.repeat(hotel.starRating)} ${hotel.userRating}/5
                    </div>
                    <div class="deal-price">$${Math.round(hotel.pricePerNight)}/nt <span class="deal-original">$${Math.round(hotel.originalPrice)}</span></div>
                    <div class="deal-savings">Save ${hotel.savingsPercent}%</div>
                    <button class="btn-book" style="background: var(--secondary);" onclick="window.open('${hotel.bookingUrl}', '_blank')">View Hotel</button>
                </div>
            `;
        }
        
        function renderVenue(venue, type) {
            const color = type === 'dining' ? '#f59e0b' : '#8b5cf6';
            const icon = type === 'dining' ? 'üçΩÔ∏è' : 'üç∫';
            return `
                <div class="deal-card" style="border-left-color: ${color};">
                    <span style="background: ${color}20; color: ${color}; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.7rem; font-weight: 600; margin-bottom: 0.5rem; display: inline-block;">${icon} ${venue.priceLevel || '$$'}</span>
                    <div class="deal-route">${venue.name}</div>
                    <div class="deal-info">
                        üìç ${venue.location}<br>
                        ‚≠ê ${venue.rating}/5 (${venue.reviewCount} reviews)
                    </div>
                    <button class="btn-book" style="background: ${color};" onclick="window.open('${venue.url}', '_blank')">View</button>
                </div>
            `;
        }
        
        // Save/unsave trips
        function isSaved(deal) {
            return savedTrips.some(s => JSON.stringify(s) === JSON.stringify(deal));
        }
        
        function toggleSave(deal) {
            const index = savedTrips.findIndex(s => JSON.stringify(s) === JSON.stringify(deal));
            if (index > -1) {
                savedTrips.splice(index, 1);
            } else {
                savedTrips.push(deal);
            }
            localStorage.setItem('saved_trips', JSON.stringify(savedTrips));
            updateSavedCount();
            applyFilters(); // Refresh display
        }
        
        function updateSavedCount() {
            const count = savedTrips.length;
            document.getElementById('savedCount').textContent = count;
            document.getElementById('savedSection').style.display = count > 0 ? 'block' : 'none';
        }
        
        function showSaved() {
            document.getElementById('sectionTitle').textContent = '‚ù§Ô∏è Your Saved Trips';
            document.getElementById('dealCount').textContent = `${savedTrips.length} saved`;
            
            if (savedTrips[0] && savedTrips[0].destination) {
                displayBundles(savedTrips);
            } else {
                displayIndividual(savedTrips, 'mixed');
            }
        }
        
        // Set alert
        function setAlert(deal) {
            const existing = alertsList.some(a => JSON.stringify(a.deal) === JSON.stringify(deal));
            if (!existing) {
                alertsList.push({
                    deal,
                    createdAt: new Date().toISOString()
                });
                localStorage.setItem('alerts_list', JSON.stringify(alertsList));
                alert('üîî Alert set! We\'ll notify you when this deal gets cheaper.');
            } else {
                alert('You already have an alert for this deal!');
            }
        }
        
        // View toggles
        function showBundles() {
            currentView = 'bundles';
            document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('categoryFilter').value = 'bundles';
            applyFilters();
        }
        
        function showIndividual() {
            currentView = 'individual';
            document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('categoryFilter').value = 'all';
            applyFilters();
        }
        
        // Helper functions
        function getDestName(code) {
            const names = {
                'LAS': 'Las Vegas', 'SFO': 'San Francisco', 'PHX': 'Phoenix',
                'SEA': 'Seattle', 'DEN': 'Denver', 'SAN': 'San Diego',
                'PDX': 'Portland', 'SLC': 'Salt Lake City', 'BOS': 'Boston',
                'NYC': 'New York', 'MIA': 'Miami', 'AUS': 'Austin',
                'HNL': 'Honolulu', 'OGG': 'Maui', 'LIH': 'Kauai'
            };
            return names[code] || code;
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }
        
        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return `${Math.floor(seconds / 60)} min ago`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;
            return `${Math.floor(seconds / 86400)} days ago`;
        }
        
        // ROI Calculator
        function calculateROI() {
            const trips = parseInt(document.getElementById('roiTrips').value);
            const hours = parseInt(document.getElementById('roiHours').value);
            
            const totalHours = trips * hours;
            document.getElementById('roiTime').textContent = totalHours;
            
            const savings = Math.round(trips * 450 * 0.30); // Bundles save more
            document.getElementById('roiMoney').textContent = `$${savings.toLocaleString()}`;
        }
        
        // Handle signup
        function handleSignup(e) {
            e.preventDefault();
            const email = document.getElementById('emailInput').value;
            
            const subs = JSON.parse(localStorage.getItem('weekend_radar_subs') || '[]');
            if (!subs.some(s => s.email === email)) {
                subs.push({ email, date: new Date().toISOString() });
                localStorage.setItem('weekend_radar_subs', JSON.stringify(subs));
            }
            
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('successMessage').style.display = 'block';
        }
        
        // Initialize
        calculateROI();
        loadAllData();
        
        // Set first vibe button as active
        document.querySelector('.vibe-btn').classList.add('active');
    </script>
</body>
</html>
