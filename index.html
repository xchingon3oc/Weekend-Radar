<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekend Radar - SoCal Travel Deals Scanner</title>
    <meta name="description" content="Auto-updated weekend flight, hotel & activity deals from LAX, ONT, SNA. Filter by airport and category.">
    
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f9fafb;
            --radar-green: #22c55e;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .update-banner {
            background: var(--dark);
            color: #9ca3af;
            padding: 0.5rem;
            text-align: center;
            font-size: 0.85rem;
        }
        
        .update-time {
            color: var(--radar-green);
            font-weight: 600;
        }
        
        .hero {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: white;
            padding: 2.5rem 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background: conic-gradient(from 0deg, transparent 0deg, rgba(34, 197, 94, 0.1) 30deg, transparent 60deg);
            animation: radar-sweep 4s linear infinite;
            transform-origin: center;
        }
        
        @keyframes radar-sweep {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        .hero-content {
            position: relative;
            z-index: 10;
        }
        
        .logo {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
            color: var(--radar-green);
        }
        
        .hero p {
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 1.5rem;
        }
        
        .filters {
            max-width: 700px;
            margin: 0 auto 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
        }
        
        .form-select, .form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.95rem;
            background: rgba(255,255,255,0.95);
        }
        
        .airports {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }
        
        .airport {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid var(--radar-green);
            padding: 0.4rem 1.2rem;
            border-radius: 30px;
            font-weight: 600;
            color: var(--radar-green);
        }
        
        .signup-box {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            max-width: 450px;
            margin: 0 auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .signup-box h3 {
            color: var(--dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .btn-signup {
            width: 100%;
            background: var(--radar-green);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .btn-signup:hover {
            background: #16a34a;
        }
        
        .southwest-banner {
            background: #304CB2;
            color: white;
            padding: 0.75rem;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .southwest-banner a {
            color: #FFBF27;
            font-weight: bold;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .deal-count {
            background: var(--radar-green);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .deals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }
        
        .deal-card {
            background: white;
            border-radius: 10px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid var(--radar-green);
            transition: transform 0.2s;
        }
        
        .deal-card:hover {
            transform: translateY(-3px);
        }
        
        .deal-card.hot {
            border-left-color: var(--danger);
        }
        
        .deal-badge {
            display: inline-block;
            background: #fecaca;
            color: var(--danger);
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .deal-route {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
        }
        
        .deal-price {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--success);
        }
        
        .deal-original {
            text-decoration: line-through;
            color: #9ca3af;
            font-size: 0.95rem;
        }
        
        .deal-savings {
            color: var(--danger);
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
        
        .deal-info {
            color: #6b7280;
            font-size: 0.85rem;
            margin-bottom: 0.75rem;
        }
        
        .btn-book {
            width: 100%;
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
            color: #6b7280;
        }
        
        .no-data {
            background: #fef3c7;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            color: #92400e;
        }
        
        .roi-section {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            padding: 3rem 1rem;
        }
        
        .roi-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 800px;
            margin: 0 auto;
            box-shadow: 0 10px 40px rgba(16, 185, 129, 0.2);
        }
        
        .roi-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .roi-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .roi-result {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .roi-result.money {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .roi-number {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0.5rem 0;
        }
        
        .footer {
            background: var(--dark);
            color: #9ca3af;
            padding: 1.5rem;
            text-align: center;
            font-size: 0.85rem;
        }
        
        .footer a {
            color: #9ca3af;
            margin: 0 0.75rem;
            text-decoration: none;
        }
        
        .success-message {
            display: none;
            background: #dcfce7;
            color: #166534;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .hero h1 { font-size: 2rem; }
            .filters { grid-template-columns: 1fr; }
            .deals-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Last Updated Banner -->
    <div class="update-banner">
        üì° Last scan: <span class="update-time" id="lastUpdated">Loading...</span>
        ‚Ä¢ Auto-updates every 6 hours
    </div>
    
    <!-- Southwest Warning -->
    <div class="southwest-banner">
        ‚ö†Ô∏è <strong>Radar blind spot:</strong> Southwest doesn't share data. 
        <a href="https://www.southwest.com/air/booking/" target="_blank">Check Southwest.com ‚Üí</a>
        (2 free bags!)
    </div>
    
    <!-- Hero -->
    <section class="hero">
        <div class="hero-content">
            <div class="logo">üì°</div>
            <h1>Weekend Radar</h1>
            <p>Scanning for the best weekend deals from SoCal airports. Filter by your airport and interests.</p>
            
            <!-- Filters -->
            <div class="filters">
                <select id="airportFilter" class="form-select" onchange="applyFilters()">
                    <option value="all">All Airports</option>
                    <option value="LAX">LAX - Los Angeles</option>
                    <option value="ONT">ONT - Ontario</option>
                    <option value="SNA">SNA - John Wayne (OC)</option>
                </select>
                <select id="categoryFilter" class="form-select" onchange="applyFilters()">
                    <option value="all">All Categories</option>
                    <option value="flights">‚úàÔ∏è Flights</option>
                    <option value="hotels">üè® Hotels</option>
                    <option value="arts">üé≠ Arts & Theater</option>
                    <option value="sports">üèà Sports</option>
                    <option value="comedy">üòÇ Comedy</option>
                    <option value="dining">üçΩÔ∏è Dining</option>
                    <option value="bars">üç∫ Bars & Nightlife</option>
                </select>
            </div>
            
            <div class="airports">
                <div class="airport">LAX</div>
                <div class="airport">ONT</div>
                <div class="airport">SNA</div>
            </div>
            
            <div class="signup-box">
                <h3>üì° Get on the Radar</h3>
                <form id="signupForm" onsubmit="handleSignup(event)">
                    <input type="email" class="form-input" placeholder="Your email" required id="emailInput">
                    <button type="submit" class="btn-signup">Join Free ‚Ä¢ No Spam</button>
                </form>
                <div class="success-message" id="successMessage">
                    ‚úÖ You're on the radar!
                </div>
            </div>
        </div>
    </section>
    
    <!-- Deals Display -->
    <section class="container" id="dealsSection">
        <div class="section-header">
            <h2 class="section-title" id="sectionTitle">üì° All Deals</h2>
            <span class="deal-count" id="dealCount">Scanning...</span>
        </div>
        <div class="deals-grid" id="dealsGrid">
            <div class="loading">üì° Scanning for deals...</div>
        </div>
    </section>
    
    <!-- ROI Calculator -->
    <section class="roi-section">
        <div class="container">
            <h2 class="section-title" style="text-align: center; margin-bottom: 1rem;">üí∞ See What You're Saving</h2>
            <p style="text-align: center; color: #065f46; margin-bottom: 2rem;">Weekend Radar does the searching for you. Here's what that's worth:</p>
            
            <div class="roi-card">
                <div class="roi-controls">
                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Weekend trips per year</label>
                        <select id="roiTrips" class="form-select" onchange="calculateROI()">
                            <option value="2">2 trips</option>
                            <option value="4" selected>4 trips</option>
                            <option value="6">6 trips</option>
                            <option value="12">12 trips</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Hours spent searching per trip</label>
                        <select id="roiHours" class="form-select" onchange="calculateROI()">
                            <option value="1">1 hour</option>
                            <option value="2">2 hours</option>
                            <option value="3" selected>3 hours</option>
                            <option value="5">5+ hours</option>
                        </select>
                    </div>
                </div>
                
                <div class="roi-results">
                    <div class="roi-result">
                        <div style="font-size: 0.9rem; opacity: 0.9;">‚è∞ Time Saved Per Year</div>
                        <div class="roi-number" id="roiTime">12</div>
                        <div>hours back in your life</div>
                    </div>
                    <div class="roi-result money">
                        <div style="font-size: 0.9rem; opacity: 0.9;">üí∞ Money Saved Per Year</div>
                        <div class="roi-number" id="roiMoney">$800</div>
                        <div>on average (30% savings)</div>
                    </div>
                </div>
                
                <p style="text-align: center; color: #6b7280; font-size: 0.85rem; margin-top: 1.5rem;">
                    * Based on typical deal discounts of 25-35% and eliminating manual search time across multiple sites
                </p>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="footer">
        <p style="margin-bottom: 0.5rem;">
            <strong style="color: var(--radar-green);">Weekend Radar</strong> ‚Ä¢ SoCal's Deal Scanner
        </p>
        <p>
            <a href="#">Privacy</a>
            <a href="#">Terms</a>
            <a href="#">Affiliate Disclosure</a>
        </p>
        <p style="margin-top: 0.75rem; font-size: 0.8rem;">
            ¬© 2024 Weekend Radar ‚Ä¢ Auto-updated ‚Ä¢ Affiliate links help keep the radar running
        </p>
    </footer>
    
    <script>
        // Data storage
        let allDeals = {
            flights: [],
            hotels: [],
            events: [],
            dining: [],
            bars: []
        };
        
        // Load all data
        async function loadAllData() {
            try {
                // Load flights
                const flightsRes = await fetch('./deals_data.json');
                allDeals.flights = await flightsRes.json();
                
                // Load hotels
                const hotelsRes = await fetch('./hotels_data.json');
                allDeals.hotels = await hotelsRes.json();
                
                // Load events
                const eventsRes = await fetch('./events_data.json');
                allDeals.events = await eventsRes.json();
                
                // Load dining (optional - won't fail if missing)
                try {
                    const diningRes = await fetch('./dining_data.json');
                    allDeals.dining = await diningRes.json();
                } catch(e) {}
                
                // Load bars (optional - won't fail if missing)
                try {
                    const barsRes = await fetch('./bars_data.json');
                    allDeals.bars = await barsRes.json();
                } catch(e) {}
                
                // Load metadata
                const metaRes = await fetch('./metadata.json');
                const meta = await metaRes.json();
                document.getElementById('lastUpdated').textContent = getTimeAgo(new Date(meta.lastUpdated));
                
                // Apply initial filters
                applyFilters();
                
            } catch (error) {
                document.getElementById('dealsGrid').innerHTML = '<div class="no-data">Radar offline. Refresh to retry.</div>';
            }
        }
        
        // Apply filters
        function applyFilters() {
            const airport = document.getElementById('airportFilter').value;
            const category = document.getElementById('categoryFilter').value;
            
            // Save preferences
            localStorage.setItem('preferred_airport', airport);
            localStorage.setItem('preferred_category', category);
            
            let filtered = [];
            let title = 'üì° ';
            
            if (category === 'all') {
                // Show everything
                filtered = [
                    ...filterFlights(allDeals.flights, airport).slice(0, 6),
                    ...allDeals.hotels.slice(0, 3),
                    ...allDeals.events.slice(0, 6),
                    ...allDeals.dining.slice(0, 3),
                    ...allDeals.bars.slice(0, 3)
                ];
                title += 'All Deals';
            } else if (category === 'flights') {
                filtered = filterFlights(allDeals.flights, airport);
                title += 'Flight Deals';
            } else if (category === 'hotels') {
                filtered = allDeals.hotels;
                title += 'Hotel Deals';
            } else if (category === 'arts' || category === 'sports' || category === 'comedy') {
                filtered = filterEvents(allDeals.events, category);
                title += getCategoryName(category);
            } else if (category === 'dining') {
                filtered = allDeals.dining;
                title += 'Dining Deals';
            } else if (category === 'bars') {
                filtered = allDeals.bars;
                title += 'Bar & Nightlife';
            }
            
            document.getElementById('sectionTitle').textContent = title;
            document.getElementById('dealCount').textContent = `${filtered.length} detected`;
            
            displayDeals(filtered, category);
        }
        
        // Filter functions
        function filterFlights(flights, airport) {
            if (airport === 'all') return flights;
            return flights.filter(f => f.origin === airport);
        }
        
        function filterEvents(events, category) {
            const categoryMap = {
                'arts': ['Arts & Theatre', 'Arts', 'Theatre', 'Theater'],
                'sports': ['Sports'],
                'comedy': ['Comedy']
            };
            const cats = categoryMap[category] || [];
            return events.filter(e => cats.some(c => e.category.includes(c)));
        }
        
        function getCategoryName(cat) {
            const names = {
                'arts': 'Arts & Theater',
                'sports': 'Sports Events',
                'comedy': 'Comedy Shows'
            };
            return names[cat] || cat;
        }
        
        // Display deals
        function displayDeals(deals, type) {
            if (!deals || deals.length === 0) {
                document.getElementById('dealsGrid').innerHTML = '<div class="no-data">No deals match your filters. Try different settings!</div>';
                return;
            }
            
            const html = deals.map(deal => {
                if (deal.origin) return renderFlight(deal);
                if (deal.checkIn) return renderHotel(deal);
                if (deal.venue) return renderEvent(deal);
                if (deal.rating) return renderVenue(deal);
                return '';
            }).join('');
            
            document.getElementById('dealsGrid').innerHTML = html;
        }
        
        // Render functions
        function renderFlight(flight) {
            return `
                <div class="deal-card ${flight.isHot ? 'hot' : ''}">
                    ${flight.isHot ? '<span class="deal-badge">üî• HOT DEAL</span>' : ''}
                    <div class="deal-route">${flight.origin} ‚Üí ${getDestName(flight.destination)}</div>
                    <div class="deal-price">$${Math.round(flight.price)} <span class="deal-original">$${Math.round(flight.originalPrice)}</span></div>
                    <div class="deal-savings">Save ${flight.savingsPercent}%</div>
                    <div class="deal-info">
                        ‚úàÔ∏è ${flight.airline}<br>
                        üìÖ ${formatDate(flight.departureDate)} - ${formatDate(flight.returnDate)}
                    </div>
                    <button class="btn-book" onclick="window.open('${flight.bookingUrl}', '_blank')">View Deal</button>
                </div>
            `;
        }
        
        function renderHotel(hotel) {
            return `
                <div class="deal-card" style="border-left-color: var(--secondary);">
                    <div class="deal-route">${hotel.name}</div>
                    <div style="color: var(--secondary); font-size: 0.9rem; margin-bottom: 0.3rem;">
                        üìç ${hotel.city} ‚Ä¢ ${'‚≠ê'.repeat(hotel.starRating)} ${hotel.userRating}/5
                    </div>
                    <div class="deal-price">$${Math.round(hotel.pricePerNight)}/nt <span class="deal-original">$${Math.round(hotel.originalPrice)}</span></div>
                    <div class="deal-savings">Save ${hotel.savingsPercent}%</div>
                    <div class="deal-info">üìÖ ${formatDate(hotel.checkIn)} - ${formatDate(hotel.checkOut)}</div>
                    <button class="btn-book" style="background: var(--secondary);" onclick="window.open('${hotel.bookingUrl}', '_blank')">View Hotel</button>
                </div>
            `;
        }
        
        function renderEvent(event) {
            return `
                <div class="deal-card" style="border-left-color: #8b5cf6;">
                    <span style="display: inline-block; background: #ede9fe; color: #7c3aed; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.7rem; font-weight: 600; margin-bottom: 0.5rem;">${event.category}</span>
                    <div class="deal-route">${event.name}</div>
                    <div class="deal-info">
                        üìç ${event.venue}, ${event.city}<br>
                        üìÖ ${formatDate(event.date)} at ${event.time}
                    </div>
                    <div class="deal-price" style="font-size: 1.4rem;">
                        ${event.priceMin > 0 ? `$${event.priceMin} - $${event.priceMax}` : 'Free'}
                    </div>
                    <button class="btn-book" style="background: #8b5cf6;" onclick="window.open('${event.url}', '_blank')">Get Tickets</button>
                </div>
            `;
        }
        
        function renderVenue(venue) {
            const color = venue.type === 'dining' ? '#f59e0b' : '#8b5cf6';
            const icon = venue.type === 'dining' ? 'üçΩÔ∏è' : 'üç∫';
            return `
                <div class="deal-card" style="border-left-color: ${color};">
                    <span style="display: inline-block; background: ${color}20; color: ${color}; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.7rem; font-weight: 600; margin-bottom: 0.5rem;">${icon} ${venue.priceLevel || '$$'}</span>
                    <div class="deal-route">${venue.name}</div>
                    <div class="deal-info">
                        üìç ${venue.location}<br>
                        ‚≠ê ${venue.rating}/5 (${venue.reviewCount} reviews)
                    </div>
                    <button class="btn-book" style="background: ${color};" onclick="window.open('${venue.url}', '_blank')">View Details</button>
                </div>
            `;
        }
        
        // Helper functions
        function getDestName(code) {
            const names = {
                'LAS': 'Las Vegas', 'SFO': 'San Francisco', 'PHX': 'Phoenix',
                'SEA': 'Seattle', 'DEN': 'Denver', 'SAN': 'San Diego',
                'PDX': 'Portland', 'SLC': 'Salt Lake City', 'BOS': 'Boston',
                'NYC': 'New York', 'MIA': 'Miami', 'AUS': 'Austin'
            };
            return names[code] || code;
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }
        
        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return `${Math.floor(seconds / 60)} min ago`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;
            return `${Math.floor(seconds / 86400)} days ago`;
        }
        
        // ROI Calculator
        function calculateROI() {
            const trips = parseInt(document.getElementById('roiTrips').value);
            const hours = parseInt(document.getElementById('roiHours').value);
            
            // Time saved
            const totalHours = trips * hours;
            document.getElementById('roiTime').textContent = totalHours;
            
            // Money saved (estimate $400 per trip at 30% savings)
            const savings = Math.round(trips * 400 * 0.30);
            document.getElementById('roiMoney').textContent = `$${savings.toLocaleString()}`;
        }
        
        // Handle signup
        function handleSignup(e) {
            e.preventDefault();
            const email = document.getElementById('emailInput').value;
            
            const subs = JSON.parse(localStorage.getItem('weekend_radar_subs') || '[]');
            if (!subs.some(s => s.email === email)) {
                subs.push({ email, date: new Date().toISOString() });
                localStorage.setItem('weekend_radar_subs', JSON.stringify(subs));
            }
            
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('successMessage').style.display = 'block';
        }
        
        // Initialize
        calculateROI();
        loadAllData();
        
        // Load saved preferences
        const savedAirport = localStorage.getItem('preferred_airport');
        const savedCategory = localStorage.getItem('preferred_category');
        if (savedAirport) document.getElementById('airportFilter').value = savedAirport;
        if (savedCategory) document.getElementById('categoryFilter').value = savedCategory;
    </script>
</body>
</html>
